@model IEnumerable<TNAI_Proj.Models.Order>

@{
    ViewData["Title"] = "Manage Orders";
}

<div class="container mt-4">
    <h1 class="mb-4">Manage Orders</h1>

    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Order ID</th>
                    <th>Customer</th>
                    <th>Car</th>
                    <th>Total Amount</th>
                    <th>Status</th>
                    <th>Order Date</th>
                    <th>Completion Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var order in Model)
                {
                    <tr>
                        <td>@order.Id</td>
                        <td>@order.User?.Name</td>
                        <td>@order.Car?.Name</td>
                        <td>@order.TotalAmount.ToString("C")</td>
                        <td>
                            <span class="badge @(order.Status switch {
                                "Completed" => "bg-success",
                                "Pending" => "bg-warning",
                                "Cancelled" => "bg-danger",
                                "Refunded" => "bg-info",
                                _ => "bg-secondary"
                            })">@order.Status</span>
                        </td>
                        <td>@order.OrderDate.ToString("g")</td>
                        <td>@(order.CompletionDate?.ToString("g") ?? "N/A")</td>
                        <td>
                            <form asp-action="UpdateOrderStatus" method="post" class="d-inline">
                                <input type="hidden" name="id" value="@order.Id" />
                                <select name="status" class="form-select form-select-sm d-inline-block w-auto">
                                    @{
                                        var statuses = new[] { "Pending", "Completed", "Cancelled", "Refunded" };
                                        foreach (var status in statuses)
                                        {
                                            if (status == order.Status)
                                            {
                                                <option value="@status" selected>@status</option>
                                            }
                                            else
                                            {
                                                <option value="@status">@status</option>
                                            }
                                        }
                                    }
                                </select>
                                <button type="submit" class="btn btn-primary btn-sm">Update</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div> 